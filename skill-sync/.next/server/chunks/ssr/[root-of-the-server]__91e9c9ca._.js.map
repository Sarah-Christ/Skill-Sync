{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 159, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ELCOT/Desktop/loginform/app/editProfile/page.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { auth, db, storage } from \"../../firebaseConfigs/firebaseConfig\";\r\nimport { doc, getDoc, updateDoc, enableNetwork } from \"firebase/firestore\";\r\nimport { ref, uploadBytes, getDownloadURL } from \"firebase/storage\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\n\r\nexport default function EditProfile() {\r\n  const router = useRouter();\r\n  const [user, setUser] = useState(null);\r\n  const [profile, setProfile] = useState({\r\n    name: \"\",\r\n    offerSkills: \"\",\r\n    wantSkills: \"\",\r\n    profilePic: \"\",\r\n  });\r\n  const [uploading, setUploading] = useState(false);\r\n\r\n  // 🔌 Ensure Firestore is online before any calls\r\n  useEffect(() => {\r\n    enableNetwork(db)\r\n      .then(() => console.log(\"✅ Firestore network enabled\"))\r\n      .catch((err) => console.error(\"❌ Failed to enable network:\", err));\r\n  }, []);\r\n\r\n  // 👤 Get current user\r\n  useEffect(() => {\r\n    const unsubscribe = onAuthStateChanged(auth, async (currentUser) => {\r\n      if (currentUser) {\r\n        setUser(currentUser);\r\n\r\n        const docRef = doc(db, \"users\", currentUser.uid);\r\n        const docSnap = await getDoc(docRef);\r\n\r\n        if (docSnap.exists()) {\r\n          setProfile(docSnap.data());\r\n        }\r\n      } else {\r\n        router.push(\"/login\");\r\n      }\r\n    });\r\n\r\n    return () => unsubscribe();\r\n  }, []);\r\n\r\n  // 📤 Handle profile image upload\r\n  const handleImageUpload = async (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file || !user) return;\r\n\r\n    setUploading(true);\r\n    const storageRef = ref(storage, `profilePics/${user.uid}`);\r\n    await uploadBytes(storageRef, file);\r\n\r\n    const downloadURL = await getDownloadURL(storageRef);\r\n    setProfile((prev) => ({ ...prev, profilePic: downloadURL }));\r\n    setUploading(false);\r\n  };\r\n\r\n  // ✅ Save profile to Firestore\r\n  const handleSave = async () => {\r\n    if (!user) return;\r\n\r\n    const userRef = doc(db, \"users\", user.uid);\r\n    await updateDoc(userRef, {\r\n      name: profile.name,\r\n      offerSkills: profile.offerSkills,\r\n      wantSkills: profile.wantSkills,\r\n      profilePic: profile.profilePic,\r\n    });\r\n\r\n    alert(\"Profile updated!\");\r\n    router.push(\"/dashboard\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-4 max-w-xl mx-auto\">\r\n      <h1 className=\"text-2xl font-semibold mb-4\">Edit Profile</h1>\r\n\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"Your name\"\r\n        value={profile.name}\r\n        onChange={(e) => setProfile({ ...profile, name: e.target.value })}\r\n        className=\"border p-2 mb-2 w-full\"\r\n      />\r\n\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"Skills you offer\"\r\n        value={profile.offerSkills}\r\n        onChange={(e) => setProfile({ ...profile, offerSkills: e.target.value })}\r\n        className=\"border p-2 mb-2 w-full\"\r\n      />\r\n\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"Skills you want to learn\"\r\n        value={profile.wantSkills}\r\n        onChange={(e) => setProfile({ ...profile, wantSkills: e.target.value })}\r\n        className=\"border p-2 mb-4 w-full\"\r\n      />\r\n\r\n      <div className=\"mb-4\">\r\n        {profile.profilePic && (\r\n          <img src={profile.profilePic} alt=\"Profile\" className=\"w-24 h-24 rounded-full mb-2\" />\r\n        )}\r\n        <input type=\"file\" onChange={handleImageUpload} className=\"mb-2\" />\r\n        {uploading && <p>Uploading image...</p>}\r\n      </div>\r\n\r\n      <button onClick={handleSave} className=\"bg-blue-500 text-white px-4 py-2 rounded\">\r\n        Save Profile\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}